
"""
certifi.py
~~~~~~~~~~

This module returns the installation location of cacert.pem or its contents.
"""
import os


class _PipPatchedCertificate(Exception):
    pass


DEBIAN_CA_CERTS_PATH = '/etc/ssl/certs/ca-certificates.crt'

try:
    _PIP_STANDALONE_CERT = os.environ.get("_PIP_STANDALONE_CERT")
    if _PIP_STANDALONE_CERT:
        def where():
            return _PIP_STANDALONE_CERT
        raise _PipPatchedCertificate()

    from importlib.resources import path as get_path, read_text

    _CACERT_CTX = None
    _CACERT_PATH = None

    def where():
        global _CACERT_CTX
        global _CACERT_PATH
        if _CACERT_PATH is None:
            _CACERT_PATH = DEBIAN_CA_CERTS_PATH

        return _CACERT_PATH

except _PipPatchedCertificate:
    pass

except ImportError:
    def read_text(_module, _path, encoding="ascii"):
        with open(where(), "r", encoding=encoding) as data:
            return data.read()

    def where():
        return DEBIAN_CA_CERTS_PATH


def contents():
    with open(where(), "r", encoding="ascii") as data:
        return data.read()
